<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>RaspaCash - Sistema de Raspadinha Online</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Meta Tags para SEO -->
    <meta name="description" content="RaspaCash - O melhor sistema de raspadinha online do Brasil! Ganhe pr√™mios encontrando 3 n√∫meros iguais!">
    <meta name="keywords" content="raspadinha, loteria, pr√™mios, jogos, Brasil, dinheiro, PIX">
    <meta property="og:title" content="RaspaCash - Sistema de Raspadinha Online">
    <meta property="og:description" content="Encontre 3 n√∫meros iguais e ganhe o valor em reais!">
    <meta property="og:url" content="https://raspacashbr.online">
    <meta property="og:type" content="website">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé∞</text></svg>">
    
    <style>
        /* Anima√ß√µes customizadas */
        @keyframes pulse-gold {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
            }
            50% { 
                box-shadow: 0 0 40px rgba(251, 191, 36, 0.8);
            }
        }
        
        .animate-pulse-gold {
            animation: pulse-gold 2s infinite;
        }
        
        @keyframes shine {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }
        
        .animate-shine {
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.3) 50%, transparent 70%);
            background-size: 200% 200%;
            animation: shine 2s infinite;
        }
        
        /* Canvas para raspadinha */
        .scratch-canvas {
            cursor: crosshair;
            user-select: none;
            -webkit-user-select: none;
            touch-action: none;
        }
        
        /* Esconder scrollbar mas manter funcionalidade */
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        
        /* N√∫meros ganhadores destacados */
        .winning-number {
            animation: winning-glow 1s infinite alternate;
        }
        
        @keyframes winning-glow {
            0% { 
                box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
                transform: scale(1);
            }
            100% { 
                box-shadow: 0 0 20px rgba(34, 197, 94, 0.8);
                transform: scale(1.05);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 text-white min-h-screen min-h-[100dvh] overflow-x-hidden">
    <!-- Container Principal -->
    <div id="app">
        <!-- Tela de Login -->
        <div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
            <div class="bg-gradient-to-br from-purple-900/90 via-blue-900/90 to-cyan-900/90 backdrop-blur-lg rounded-2xl p-8 max-w-md w-full border border-cyan-400/30 shadow-2xl">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent mb-2">
                        üé∞ RaspaCash
                    </h1>
                    <p class="text-cyan-300">Entre para come√ßar a raspar e ganhar!</p>
                    <p class="text-sm text-gray-400 mt-2">Encontre 3 n√∫meros iguais e ganhe!</p>
                </div>
                
                <div class="space-y-4">
                    <input
                        type="text"
                        id="userName"
                        placeholder="Seu nome completo"
                        class="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-400"
                        required
                    />
                    <input
                        type="email"
                        id="userEmail"
                        placeholder="Seu e-mail"
                        class="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-400"
                        required
                    />
                    <button
                        onclick="handleLogin()"
                        id="loginButton"
                        class="w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-600 disabled:to-gray-700 text-white font-bold py-3 rounded-lg transition-all duration-300 transform hover:scale-105 disabled:hover:scale-100"
                    >
                        üé≤ Entrar e Jogar
                    </button>
                </div>
                
                <div class="mt-6 text-center text-sm text-gray-400">
                    <p>üéØ Regra: Encontre 3 n√∫meros iguais para ganhar o valor em R$!</p>
                    <p class="mt-2">Ao entrar, voc√™ concorda com nossos termos de uso</p>
                </div>
            </div>
        </div>

        <!-- √Årea Principal do Jogo -->
        <div id="gameArea" class="hidden min-h-screen p-4">
            <!-- Header -->
            <header class="flex justify-between items-center mb-6 bg-gradient-to-r from-purple-900/50 to-blue-900/50 backdrop-blur-lg rounded-xl p-4 border border-cyan-400/20">
                <div class="flex items-center space-x-3">
                    <h1 class="text-2xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                        üé∞ RaspaCash
                    </h1>
                    <span class="text-sm text-cyan-300" id="userWelcome"></span>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Saldo:</div>
                    <div class="text-xl font-bold text-green-400" id="userBalance">R$ 0,00</div>
                </div>
            </header>

            <!-- Regras do Jogo -->
            <div class="bg-gradient-to-r from-blue-900/50 to-purple-900/50 backdrop-blur-lg rounded-xl p-4 mb-6 border border-blue-400/20">
                <h2 class="text-lg font-bold text-yellow-300 mb-2">üéØ Como Ganhar:</h2>
                <p class="text-cyan-200 text-sm">
                    Raspe a cartela com o dedo e encontre <strong>3 n√∫meros iguais</strong> para ganhar o valor em reais!
                    <br>
                    <span class="text-green-300">Exemplo: 5-5-5 = R$ 5,00 | 10-10-10 = R$ 10,00</span>
                </p>
            </div>

            <!-- Sele√ß√£o de Planos -->
            <div id="planSelection" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- Plano B√°sico -->
                <div class="plan-card bg-gradient-to-br from-green-800/90 via-green-700/90 to-green-600/90 backdrop-blur-lg rounded-xl p-6 border border-green-400/30 shadow-2xl cursor-pointer transform hover:scale-105 transition-all duration-300" data-plan="basic">
                    <div class="text-center">
                        <div class="text-4xl mb-4">üåü</div>
                        <h3 class="text-2xl font-bold text-green-300 mb-2">PLANO B√ÅSICO</h3>
                        <div class="text-3xl font-bold text-white mb-2">R$ 3,00</div>
                        <p class="text-green-200 mb-4">N√∫meros de 1 a 10</p>
                        <div class="bg-green-700/50 rounded-lg p-3 mb-4">
                            <div class="text-sm text-green-100">‚Ä¢ 1 cartela</div>
                            <div class="text-sm text-green-100">‚Ä¢ Pr√™mios: R$ 1 a R$ 10</div>
                            <div class="text-sm text-green-100">‚Ä¢ Chance: 0.01%</div>
                            <div class="text-sm text-green-100">‚Ä¢ PIX instant√¢neo</div>
                        </div>
                        <button class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition-colors">
                            üé≤ Escolher Plano
                        </button>
                    </div>
                </div>

                <!-- Plano Premium -->
                <div class="plan-card bg-gradient-to-br from-purple-800/90 via-purple-700/90 to-purple-600/90 backdrop-blur-lg rounded-xl p-6 border border-purple-400/30 shadow-2xl cursor-pointer transform hover:scale-105 transition-all duration-300" data-plan="premium">
                    <div class="text-center">
                        <div class="text-4xl mb-4">üíé</div>
                        <h3 class="text-2xl font-bold text-purple-300 mb-2">PLANO PREMIUM</h3>
                        <div class="text-3xl font-bold text-white mb-2">R$ 7,00</div>
                        <p class="text-purple-200 mb-4">N√∫meros de 1 a 50</p>
                        <div class="bg-purple-700/50 rounded-lg p-3 mb-4">
                            <div class="text-sm text-purple-100">‚Ä¢ 3 cartelas</div>
                            <div class="text-sm text-purple-100">‚Ä¢ Pr√™mios: R$ 1 a R$ 50</div>
                            <div class="text-sm text-purple-100">‚Ä¢ Chance: 0.01%</div>
                            <div class="text-sm text-purple-100">‚Ä¢ PIX instant√¢neo</div>
                        </div>
                        <button class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 rounded-lg transition-colors">
                            üé≤ Escolher Plano
                        </button>
                    </div>
                </div>

                <!-- Plano VIP -->
                <div class="plan-card bg-gradient-to-br from-red-800/90 via-red-700/90 to-red-600/90 backdrop-blur-lg rounded-xl p-6 border border-red-400/30 shadow-2xl cursor-pointer transform hover:scale-105 transition-all duration-300 animate-pulse-gold" data-plan="vip">
                    <div class="text-center">
                        <div class="text-4xl mb-4">üëë</div>
                        <h3 class="text-2xl font-bold text-red-300 mb-2">PLANO VIP</h3>
                        <div class="text-3xl font-bold text-white mb-2">R$ 15,00</div>
                        <p class="text-red-200 mb-4">N√∫meros de 1 a 100</p>
                        <div class="bg-red-700/50 rounded-lg p-3 mb-4">
                            <div class="text-sm text-red-100">‚Ä¢ 5 cartelas</div>
                            <div class="text-sm text-red-100">‚Ä¢ Pr√™mios: R$ 1 a R$ 100</div>
                            <div class="text-sm text-red-100">‚Ä¢ Chance: 0.01%</div>
                            <div class="text-sm text-yellow-300 font-bold">‚Ä¢ B√îNUS EXCLUSIVO!</div>
                        </div>
                        <button class="w-full bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white font-bold py-3 rounded-lg transition-colors">
                            üëë MELHOR ESCOLHA
                        </button>
                    </div>
                </div>
            </div>

            <!-- √Årea do Jogo de Raspadinha -->
            <div id="scratchGame" class="hidden bg-gradient-to-br from-purple-900/80 via-blue-900/80 to-cyan-900/80 backdrop-blur-lg rounded-xl p-6 mb-8 border border-cyan-400/30 shadow-2xl">
                <h3 class="text-2xl font-bold text-center mb-6 text-yellow-300">üé≤ Sua Cartela de Raspadinha</h3>
                
                <!-- Container da Raspadinha -->
                <div class="max-w-md mx-auto">
                    <!-- Canvas Container -->
                    <div class="relative bg-gradient-to-br from-yellow-100 to-orange-100 rounded-lg p-4 mb-4 shadow-lg">
                        <!-- Grid de N√∫meros (por tr√°s do canvas) -->
                        <div id="numbersGrid" class="absolute inset-4 grid grid-cols-3 gap-2 z-0">
                            <!-- Os n√∫meros ser√£o gerados dinamicamente -->
                        </div>
                        
                        <!-- Canvas de Raspadinha -->
                        <canvas 
                            id="scratchCanvas" 
                            width="320" 
                            height="220"
                            class="scratch-canvas relative z-10 w-full h-full rounded-lg"
                            style="max-width: 320px; max-height: 220px;"
                        ></canvas>
                    </div>
                    
                    <!-- Barra de Progresso -->
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm text-cyan-300">√Årea raspada: <span id="scratchProgress">0%</span></span>
                            <span class="text-sm text-yellow-300 font-bold animate-pulse">ü™ô Continue raspando! ü™ô</span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-3 border border-yellow-400/30">
                            <div 
                                id="progressBar"
                                class="bg-gradient-to-r from-green-400 via-yellow-400 to-orange-400 h-3 rounded-full transition-all duration-300 shadow-lg"
                                style="width: 0%"
                            ></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Resultado -->
            <div id="gameResult" class="hidden bg-gradient-to-br from-purple-900/80 via-blue-900/80 to-cyan-900/80 backdrop-blur-lg rounded-xl p-6 mb-6 border border-cyan-400/30 shadow-2xl">
                <div class="text-center mb-4">
                    <h4 class="text-xl font-bold text-yellow-300 mb-2">üéâ Resultado da Cartela!</h4>
                    <div id="resultContent">
                        <!-- Resultado ser√° inserido aqui -->
                    </div>
                </div>
            </div>

            <!-- Bot√µes de A√ß√£o -->
            <div class="text-center space-y-4">
                <div id="nextButton" class="hidden">
                    <button
                        onclick="nextCard()"
                        class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform hover:scale-105 transition-all duration-200"
                    >
                        üé≤ Pr√≥xima Cartela
                    </button>
                </div>
                
                <div id="newGameButton" class="hidden">
                    <button
                        onclick="newGame()"
                        class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform hover:scale-105 transition-all duration-200"
                    >
                        üéÆ Novo Jogo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Estado do jogo
        let gameState = {
            user: null,
            balance: 0,
            currentPlan: null,
            scratchCard: null,
            cardsRemaining: 0,
            scratchCount: 0,
            scratchedArea: 0,
            isScratching: false,
            isRevealed: false,
            lastScratchPoint: null,
            totalPrize: 0
        };

        // Canvas e contexto
        let scratchCanvas = null;
        let scratchCtx = null;

        // Sistema de Login
        function handleLogin() {
            const name = document.getElementById('userName').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            
            if (!name || !email) {
                alert('Por favor, preencha todos os campos!');
                return;
            }
            
            if (!email.includes('@')) {
                alert('Por favor, digite um e-mail v√°lido!');
                return;
            }
            
            // Simular login
            gameState.user = { name, email };
            gameState.balance = Math.random() * 50 + 10; // Entre R$ 10-60
            
            document.getElementById('userWelcome').textContent = `Ol√°, ${name}!`;
            document.getElementById('userBalance').textContent = `R$ ${gameState.balance.toFixed(2)}`;
            
            // Esconder tela de login e mostrar jogo
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('gameArea').classList.remove('hidden');
            
            setupPlanSelection();
        }

        // Sistema de Sele√ß√£o de Planos
        function setupPlanSelection() {
            const planCards = document.querySelectorAll('.plan-card');
            
            planCards.forEach(card => {
                card.addEventListener('click', () => {
                    const plan = card.dataset.plan;
                    selectPlan(plan);
                });
            });
        }

        function selectPlan(planType) {
            const plans = {
                basic: {
                    name: 'B√°sico',
                    price: 3.00,
                    cards: 1,
                    minNumber: 1,
                    maxNumber: 10,
                    winChance: 0.0001 // 0.01%
                },
                premium: {
                    name: 'Premium',
                    price: 7.00,
                    cards: 3,
                    minNumber: 1,
                    maxNumber: 50,
                    winChance: 0.0001 // 0.01%
                },
                vip: {
                    name: 'VIP',
                    price: 15.00,
                    cards: 5,
                    minNumber: 1,
                    maxNumber: 100,
                    winChance: 0.0001 // 0.01%
                }
            };

            const selectedPlan = plans[planType];
            
            if (gameState.balance < selectedPlan.price) {
                alert('Saldo insuficiente! Adicione mais cr√©ditos para jogar.');
                return;
            }

            gameState.currentPlan = selectedPlan;
            gameState.cardsRemaining = selectedPlan.cards;
            gameState.balance -= selectedPlan.price;
            
            document.getElementById('userBalance').textContent = `R$ ${gameState.balance.toFixed(2)}`;
            document.getElementById('planSelection').classList.add('hidden');
            
            startScratchGame();
        }

        // Sistema Triple Match - Encontrar 3 n√∫meros iguais
        function generateTripleMatchCard() {
            const numbers = [];
            const plan = gameState.currentPlan;
            
            // Gerar 9 n√∫meros aleat√≥rios
            for (let i = 0; i < 9; i++) {
                const num = Math.floor(Math.random() * (plan.maxNumber - plan.minNumber + 1)) + plan.minNumber;
                numbers.push(num);
            }
            
            // Verificar se jogador ganha (0.01% de chance)
            const wins = Math.random() < plan.winChance;
            
            if (wins) {
                // For√ßar um triple match
                const winningNumber = Math.floor(Math.random() * (plan.maxNumber - plan.minNumber + 1)) + plan.minNumber;
                
                // Substituir 3 posi√ß√µes aleat√≥rias com o n√∫mero ganhador
                const positions = [0, 1, 2, 3, 4, 5, 6, 7, 8];
                const shuffledPositions = positions.sort(() => 0.5 - Math.random());
                
                for (let i = 0; i < 3; i++) {
                    numbers[shuffledPositions[i]] = winningNumber;
                }
                
                return {
                    numbers,
                    winningNumber,
                    prize: winningNumber,
                    isWinner: true
                };
            }
            
            // Garantir que n√£o h√° triple match acidental
            const numberCounts = {};
            numbers.forEach(num => {
                numberCounts[num] = (numberCounts[num] || 0) + 1;
            });
            
            // Se houver 3 ou mais iguais acidentalmente, randomizar novamente
            for (let num in numberCounts) {
                if (numberCounts[num] >= 3) {
                    // Substituir os extras por n√∫meros diferentes
                    const positions = numbers.map((n, i) => n === parseInt(num) ? i : -1).filter(i => i !== -1);
                    for (let i = 2; i < positions.length; i++) {
                        let newNum;
                        do {
                            newNum = Math.floor(Math.random() * (plan.maxNumber - plan.minNumber + 1)) + plan.minNumber;
                        } while (newNum === parseInt(num));
                        numbers[positions[i]] = newNum;
                    }
                }
            }
            
            return {
                numbers,
                winningNumber: null,
                prize: 0,
                isWinner: false
            };
        }

        // Iniciar jogo de raspadinha
        function startScratchGame() {
            gameState.scratchCard = generateTripleMatchCard();
            
            document.getElementById('scratchGame').classList.remove('hidden');
            
            setupScratchCanvas();
            renderNumbers();
            resetScratchState();
        }

        // Configurar canvas de raspadinha
        function setupScratchCanvas() {
            scratchCanvas = document.getElementById('scratchCanvas');
            scratchCtx = scratchCanvas.getContext('2d');
            
            // Criar cobertura met√°lica real√≠stica
            createMetallicScratchSurface(scratchCtx, 320, 220);
            
            // Adicionar eventos de scratch
            setupScratchEvents();
        }

        // Criar superf√≠cie met√°lica de raspadinha
        function createMetallicScratchSurface(ctx, width, height) {
            // Base met√°lica com gradiente
            const gradient = ctx.createRadialGradient(width/2, height/2, 0, width/2, height/2, width/2);
            gradient.addColorStop(0, '#E8E8E8');
            gradient.addColorStop(0.3, '#CACACA');
            gradient.addColorStop(0.6, '#A8A8A8');
            gradient.addColorStop(1, '#888888');
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, height);
            
            // Adicionar textura met√°lica com pontos brilhantes
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            for (let i = 0; i < 80; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = Math.random() * 2 + 1;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // Reflexos met√°licos
            ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            for (let i = 0; i < 20; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = Math.random() * 4 + 2;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // Sombras para profundidade
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
            for (let i = 0; i < 30; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = Math.random() * 3 + 1;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // Texto de instru√ß√£o com sombra
            ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
            ctx.shadowBlur = 2;
            ctx.shadowOffsetX = 1;
            ctx.shadowOffsetY = 1;
            
            ctx.fillStyle = '#555';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ü™ô RASPE COM O DEDO ü™ô', width/2, height/2 - 10);
            
            ctx.fillStyle = '#777';
            ctx.font = 'bold 12px Arial';
            ctx.fillText('Encontre 3 n√∫meros iguais!', width/2, height/2 + 15);
            
            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 0;
        }

        // Configurar eventos de scratch
        function setupScratchEvents() {
            // Eventos de mouse
            scratchCanvas.addEventListener('mousedown', startScratching);
            scratchCanvas.addEventListener('mousemove', scratch);
            scratchCanvas.addEventListener('mouseup', stopScratching);
            scratchCanvas.addEventListener('mouseleave', stopScratching);
            
            // Eventos de touch
            scratchCanvas.addEventListener('touchstart', startScratching, { passive: false });
            scratchCanvas.addEventListener('touchmove', scratch, { passive: false });
            scratchCanvas.addEventListener('touchend', stopScratching, { passive: false });
            scratchCanvas.addEventListener('touchcancel', stopScratching, { passive: false });
        }

        // Sistema de Scratch Emocional Otimizado
        function startScratching(e) {
            if (gameState.isRevealed) return;
            
            gameState.isScratching = true;
            gameState.lastScratchPoint = null;
            scratch(e);
        }

        function scratch(e) {
            if (!gameState.isScratching || gameState.isRevealed) return;
            
            e.preventDefault();
            
            const rect = scratchCanvas.getBoundingClientRect();
            const scaleX = scratchCanvas.width / rect.width;
            const scaleY = scratchCanvas.height / rect.height;
            
            let x, y;
            if (e.type.includes('touch')) {
                x = (e.touches[0].clientX - rect.left) * scaleX;
                y = (e.touches[0].clientY - rect.top) * scaleY;
            } else {
                x = (e.clientX - rect.left) * scaleX;
                y = (e.clientY - rect.top) * scaleY;
            }
            
            // Brush com gradiente suave e linhas conectadas
            scratchCtx.globalCompositeOperation = 'destination-out';
            
            // Conectar com ponto anterior se existir
            if (gameState.lastScratchPoint) {
                scratchCtx.lineWidth = 40;
                scratchCtx.lineCap = 'round';
                scratchCtx.lineJoin = 'round';
                
                const lineGradient = scratchCtx.createRadialGradient(x, y, 0, x, y, 20);
                lineGradient.addColorStop(0, 'rgba(255,255,255,1)');
                lineGradient.addColorStop(0.6, 'rgba(255,255,255,0.8)');
                lineGradient.addColorStop(1, 'rgba(255,255,255,0.2)');
                
                scratchCtx.strokeStyle = lineGradient;
                scratchCtx.beginPath();
                scratchCtx.moveTo(gameState.lastScratchPoint.x, gameState.lastScratchPoint.y);
                scratchCtx.lineTo(x, y);
                scratchCtx.stroke();
            }
            
            // Brush principal com gradiente
            const brushSize = 20;
            const gradient = scratchCtx.createRadialGradient(x, y, 0, x, y, brushSize);
            gradient.addColorStop(0, 'rgba(255,255,255,1)');
            gradient.addColorStop(0.6, 'rgba(255,255,255,0.8)');
            gradient.addColorStop(1, 'rgba(255,255,255,0.2)');
            
            scratchCtx.fillStyle = gradient;
            scratchCtx.beginPath();
            scratchCtx.arc(x, y, brushSize, 0, 2 * Math.PI);
            scratchCtx.fill();
            
            gameState.lastScratchPoint = { x, y };
            gameState.scratchCount++;
            
            // Verificar progresso otimizado
            if (gameState.scratchCount % 5 === 0) {
                checkScratchProgress();
            }
        }

        function stopScratching() {
            gameState.isScratching = false;
            gameState.lastScratchPoint = null;
        }

        // Verificar progresso da raspagem
        function checkScratchProgress() {
            // Calcular porcentagem raspada
            const imageData = scratchCtx.getImageData(0, 0, scratchCanvas.width, scratchCanvas.height);
            const pixels = imageData.data;
            let transparentPixels = 0;
            
            for (let i = 3; i < pixels.length; i += 4) {
                if (pixels[i] < 255) {
                    transparentPixels++;
                }
            }
            
            const totalPixels = scratchCanvas.width * scratchCanvas.height;
            const percentScratched = (transparentPixels / totalPixels) * 100;
            
            gameState.scratchedArea = percentScratched;
            
            // Atualizar UI
            document.getElementById('scratchProgress').textContent = `${percentScratched.toFixed(1)}%`;
            document.getElementById('progressBar').style.width = `${Math.min(percentScratched, 100)}%`;
            
            // Revelar quando atingir 60%
            if (percentScratched >= 60 && !gameState.isRevealed) {
                setTimeout(() => {
                    revealResult();
                }, 300); // Delay emocional para build-up
            }
        }

        // Renderizar n√∫meros
        function renderNumbers() {
            const grid = document.getElementById('numbersGrid');
            grid.innerHTML = '';
            
            if (!gameState.scratchCard) return;
            
            gameState.scratchCard.numbers.forEach((number, index) => {
                const numberElement = document.createElement('div');
                const isWinning = gameState.scratchCard.isWinner && number === gameState.scratchCard.winningNumber;
                
                numberElement.className = `bg-gradient-to-br from-yellow-400 to-orange-500 text-black font-bold text-lg rounded-lg p-3 text-center shadow-lg ${
                    isWinning ? 'winning-number ring-2 ring-green-400' : ''
                }`;
                
                numberElement.textContent = number;
                grid.appendChild(numberElement);
            });
        }

        // Revelar resultado
        function revealResult() {
            gameState.isRevealed = true;
            gameState.cardsRemaining--;
            
            // Remover completamente a cobertura
            scratchCtx.clearRect(0, 0, scratchCanvas.width, scratchCanvas.height);
            
            // Analisar os n√∫meros para triple match
            const numberCounts = {};
            gameState.scratchCard.numbers.forEach(num => {
                numberCounts[num] = (numberCounts[num] || 0) + 1;
            });
            
            let tripleMatch = null;
            for (let num in numberCounts) {
                if (numberCounts[num] >= 3) {
                    tripleMatch = parseInt(num);
                    break;
                }
            }
            
            // Mostrar resultado
            let resultHtml = '';
            
            if (tripleMatch !== null) {
                const prize = tripleMatch;
                gameState.balance += prize;
                gameState.totalPrize += prize;
                document.getElementById('userBalance').textContent = `R$ ${gameState.balance.toFixed(2)}`;
                
                // Destacar n√∫meros ganhadores
                const grid = document.getElementById('numbersGrid');
                const numberElements = grid.children;
                for (let i = 0; i < numberElements.length; i++) {
                    if (parseInt(numberElements[i].textContent) === tripleMatch) {
                        numberElements[i].classList.add('winning-number', 'ring-2', 'ring-green-400');
                    }
                }
                
                resultHtml = `
                    <div class="text-center">
                        <div class="text-6xl mb-4">üéâ</div>
                        <div class="text-2xl font-bold text-green-400 mb-2">TRIPLE MATCH!</div>
                        <div class="text-lg text-yellow-300 mb-2">Voc√™ encontrou: ${tripleMatch} - ${tripleMatch} - ${tripleMatch}</div>
                        <div class="text-4xl font-bold text-green-400 mb-4">GANHOU R$ ${prize.toFixed(2)}!</div>
                        <div class="mt-4 p-3 bg-green-900/50 rounded-lg">
                            <div class="text-green-300">üí∞ Pr√™mio adicionado ao seu saldo!</div>
                        </div>
                    </div>
                `;
            } else {
                resultHtml = `
                    <div class="text-center">
                        <div class="text-6xl mb-4">üòî</div>
                        <div class="text-xl font-bold text-orange-400 mb-4">N√£o houve triple match desta vez.</div>
                        <div class="text-sm text-gray-300 mb-4">
                            Voc√™ precisa encontrar 3 n√∫meros iguais para ganhar!
                            <br>
                            <strong>Seus n√∫meros:</strong> ${gameState.scratchCard.numbers.join(' - ')}
                        </div>
                        <div class="mt-4 p-3 bg-blue-900/50 rounded-lg">
                            <div class="text-blue-300">üé≤ Continue tentando! A sorte pode estar na pr√≥xima!</div>
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('resultContent').innerHTML = resultHtml;
            document.getElementById('gameResult').classList.remove('hidden');
            
            // Mostrar bot√µes apropriados
            if (gameState.cardsRemaining > 0) {
                document.getElementById('nextButton').classList.remove('hidden');
            } else {
                document.getElementById('newGameButton').classList.remove('hidden');
            }
        }

        // Pr√≥xima cartela
        function nextCard() {
            resetScratchState();
            document.getElementById('gameResult').classList.add('hidden');
            document.getElementById('nextButton').classList.add('hidden');
            
            startScratchGame();
        }

        // Novo jogo
        function newGame() {
            resetGameState();
            document.getElementById('gameResult').classList.add('hidden');
            document.getElementById('newGameButton').classList.add('hidden');
            document.getElementById('scratchGame').classList.add('hidden');
            document.getElementById('planSelection').classList.remove('hidden');
        }

        // Reset do estado do scratch
        function resetScratchState() {
            gameState.scratchCount = 0;
            gameState.scratchedArea = 0;
            gameState.isScratching = false;
            gameState.isRevealed = false;
            gameState.lastScratchPoint = null;
        }

        // Reset completo do jogo
        function resetGameState() {
            gameState.currentPlan = null;
            gameState.scratchCard = null;
            gameState.cardsRemaining = 0;
            gameState.totalPrize = 0;
            resetScratchState();
        }
    </script>
</body>
</html>
