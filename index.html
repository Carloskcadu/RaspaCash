import React, { useState } from 'react';

export default function RaspaCash() {
  const [isLoggedIn, setIsLoggedIn] = useState(false);
  const [balance, setBalance] = useState(0);
  const [selectedPlan, setSelectedPlan] = useState(null);
  const [user, setUser] = useState({ name: '', email: '' });
  const [showDeposit, setShowDeposit] = useState(false);
  const [showWithdraw, setShowWithdraw] = useState(false);
  const [showFeed, setShowFeed] = useState(false);
  const [depositAmount, setDepositAmount] = useState('');
  const [withdrawAmount, setWithdrawAmount] = useState('');
  const [withdrawData, setWithdrawData] = useState({
    fullName: '',
    pixKey: '',
    pixKeyType: 'cpf'
  });

  const plans = [
    {
      id: 1,
      name: "Plano Clássico",
      cost: 5,
      maxPrize: 500,
      color: "from-green-400 to-green-600",
      description: "Diversão garantida com prêmios de até R$ 500!"
    },
    {
      id: 2,
      name: "Plano Premium", 
      cost: 10,
      maxPrize: 1000,
      color: "from-purple-400 to-purple-600",
      description: "Experiência premium com prêmios de até R$ 1.000!"
    },
    {
      id: 3,
      name: "Plano VIP",
      cost: 20,
      maxPrize: 2000,
      color: "from-red-400 to-red-600",
      description: "Exclusividade VIP com prêmios de até R$ 2.000!"
    }
  ];

  const fakeWins = [
    { name: "Maria Silva", prize: 750, plan: "Premium", time: "2 min atrás" },
    { name: "João Santos", prize: 1200, plan: "VIP", time: "5 min atrás" },
    { name: "Ana Costa", prize: 450, plan: "Clássico", time: "8 min atrás" },
    { name: "Pedro Lima", prize: 850, plan: "Premium", time: "12 min atrás" },
    { name: "Carla Souza", prize: 1800, plan: "VIP", time: "15 min atrás" }
  ];

  const handleLogin = (name, email) => {
    setUser({ name, email });
    setIsLoggedIn(true);
  };

  const buyCard = (planId) => {
    const plan = plans.find(p => p.id === planId);
    
    if (balance < plan.cost) {
      alert('Saldo insuficiente! Faça um depósito.');
      setShowDeposit(true);
      return;
    }
    
    setBalance(prev => prev - plan.cost);
    setSelectedPlan(planId);
    
    // Simular jogo - 10% de chance de ganhar
    const won = Math.random() < 0.1;
    if (won) {
      const prize = Math.floor(Math.random() * (plan.maxPrize - plan.cost * 2)) + plan.cost * 2;
      setBalance(prev => prev + prize);
      alert(`🎉 PARABÉNS! Você ganhou R$ ${prize}!`);
    } else {
      alert('😔 Que pena! Não foi desta vez. Continue jogando!');
    }
  };

  if (!isLoggedIn) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 text-white flex items-center justify-center p-4">
        <div className="bg-gradient-to-br from-purple-900/90 via-blue-900/90 to-cyan-900/90 backdrop-blur-lg rounded-2xl p-8 max-w-md w-full border border-cyan-400/30 shadow-2xl">
          <div className="text-center mb-8">
            <h1 className="text-4xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent mb-2">
              RaspaCash
            </h1>
            <p className="text-cyan-300">Entre para começar a raspar e ganhar!</p>
          </div>
          
          <div className="space-y-4">
            <input
              type="text"
              placeholder="Seu nome completo"
              onChange={(e) => setUser(prev => ({ ...prev, name: e.target.value }))}
              className="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-400"
              required
            />
            <input
              type="email"
              placeholder="Seu e-mail"
              onChange={(e) => setUser(prev => ({ ...prev, email: e.target.value }))}
              className="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-400"
              required
            />
            <button
              onClick={() => handleLogin(user.name, user.email)}
              disabled={!user.name || !user.email}
              className="w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-600 disabled:to-gray-700 text-white font-bold py-3 rounded-lg transition-all duration-300 transform hover:scale-105 disabled:hover:scale-100"
            >
              🎲 Entrar e Jogar
            </button>
          </div>
          
          <div className="mt-6 text-center text-sm text-gray-400">
            <p>Ao entrar, você concorda com nossos termos de uso</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 text-white">
      {/* Header */}
      <header className="bg-gradient-to-r from-purple-900/80 via-blue-900/80 to-cyan-900/80 backdrop-blur-lg border-b border-cyan-400/30 shadow-lg">
        <div className="container mx-auto px-4 py-4 flex justify-between items-center">
          <h1 className="text-2xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
            RaspaCash
          </h1>
          
          <div className="flex items-center space-x-4">
            <div className="text-right">
              <div className="text-sm text-cyan-300">Saldo</div>
              <div className="text-xl font-bold text-green-400">R$ {balance.toFixed(2)}</div>
            </div>
            
            <button
              onClick={() => setShowDeposit(true)}
              className="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300"
            >
              💰 Depositar
            </button>
            
            <button
              onClick={() => setShowWithdraw(true)}
              className="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300"
            >
              💸 Sacar
            </button>
            
            <button
              onClick={() => setShowFeed(true)}
              className="bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300"
            >
              🏆 Ganhos
            </button>
          </div>
        </div>
      </header>

      <main className="container mx-auto px-4 py-8">
        {selectedPlan ? (
          <div className="max-w-2xl mx-auto text-center">
            <h2 className="text-2xl font-bold text-yellow-300 mb-4">Jogo Concluído!</h2>
            <button
              onClick={() => setSelectedPlan(null)}
              className="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform hover:scale-105 transition-all duration-200"
            >
              🎲 Jogar Novamente
            </button>
          </div>
        ) : (
          <div className="space-y-8">
            <div className="text-center mb-8">
              <h2 className="text-3xl font-bold text-yellow-300 mb-2">Escolha seu Plano</h2>
              <p className="text-cyan-300">Selecione o plano ideal para você!</p>
            </div>
            
            <div className="grid md:grid-cols-3 gap-6">
              {plans.map(plan => (
                <div key={plan.id} className={`bg-gradient-to-br ${plan.color} p-1 rounded-xl shadow-lg transform hover:scale-105 transition-all duration-300`}>
                  <div className="bg-gray-900/90 rounded-lg p-6 h-full">
                    <h3 className="text-xl font-bold text-yellow-300 mb-2">{plan.name}</h3>
                    <p className="text-gray-300 text-sm mb-4">{plan.description}</p>
                    
                    <div className="space-y-2 mb-4">
                      <div className="flex justify-between">
                        <span className="text-cyan-300">Custo:</span>
                        <span className="text-white font-bold">R$ {plan.cost}</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-cyan-300">Prêmio máximo:</span>
                        <span className="text-green-400 font-bold">R$ {plan.maxPrize}</span>
                      </div>
                    </div>
                    
                    <button
                      onClick={() => buyCard(plan.id)}
                      className="w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 rounded-lg transition-all duration-300"
                    >
                      🎲 Jogar Agora
                    </button>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}
      </main>

      {/* Modais */}
      {showDeposit && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
          <div className="bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 rounded-xl p-6 max-w-md w-full border border-cyan-400/30">
            <h3 className="text-xl font-bold text-yellow-300 mb-4">💰 Depósito via PIX</h3>
            
            <div className="space-y-4">
              <input
                type="number"
                placeholder="Valor (mínimo R$ 10)"
                value={depositAmount}
                onChange={(e) => setDepositAmount(e.target.value)}
                className="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white"
                min="10"
              />
              
              <div className="text-center">
                <p className="text-cyan-300 mb-2">PIX Copia e Cola:</p>
                <div className="bg-gray-800 p-3 rounded-lg font-mono text-sm text-green-400 break-all">
                  00020126580014br.gov.bcb.pix01364adb8d4e-8b5c-4d5f-9e2f-1234567890ab5204000053039865802BR5925RASPACASH LTDA6009SAO PAULO62140510RPX{depositAmount}6304ABCD
                </div>
              </div>
              
              <div className="flex space-x-3">
                <button
                  onClick={() => {
                    if (depositAmount >= 10) {
                      setBalance(prev => prev + parseFloat(depositAmount));
                      setDepositAmount('');
                      setShowDeposit(false);
                      alert(`Depósito de R$ ${depositAmount} confirmado!`);
                    }
                  }}
                  className="flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-3 rounded-lg"
                >
                  ✅ Confirmar
                </button>
                <button
                  onClick={() => setShowDeposit(false)}
                  className="flex-1 bg-gray-600 text-white font-bold py-3 rounded-lg"
                >
                  Cancelar
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {showFeed && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
          <div className="bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 rounded-xl p-6 max-w-md w-full border border-cyan-400/30">
            <h3 className="text-xl font-bold text-yellow-300 mb-4">🏆 Últimos Ganhos</h3>
            
            <div className="space-y-3 max-h-64 overflow-y-auto">
              {fakeWins.map((win, index) => (
                <div key={index} className="bg-gray-800/50 rounded-lg p-3 border border-green-400/30">
                  <div className="flex justify-between items-center">
                    <div>
                      <div className="text-white font-bold">{win.name}</div>
                      <div className="text-cyan-300 text-sm">{win.plan}</div>
                    </div>
                    <div className="text-right">
                      <div className="text-green-400 font-bold">R$ {win.prize}</div>
                      <div className="text-gray-400 text-xs">{win.time}</div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
            
            <button
              onClick={() => setShowFeed(false)}
              className="w-full mt-4 bg-gray-600 text-white font-bold py-3 rounded-lg"
            >
              Fechar
            </button>
          </div>
        </div>
      )}

      {showWithdraw && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
          <div className="bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 rounded-xl p-6 max-w-md w-full border border-cyan-400/30">
            <h3 className="text-xl font-bold text-yellow-300 mb-4">💸 Saque via PIX</h3>
            
            <div className="space-y-4">
              <input
                type="number"
                placeholder="Valor do saque"
                value={withdrawAmount}
                onChange={(e) => setWithdrawAmount(e.target.value)}
                className="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white"
                max={balance}
              />
              
              <input
                type="text"
                placeholder="Nome completo"
                value={withdrawData.fullName}
                onChange={(e) => setWithdrawData(prev => ({ ...prev, fullName: e.target.value }))}
                className="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white"
              />
              
              <select
                value={withdrawData.pixKeyType}
                onChange={(e) => setWithdrawData(prev => ({ ...prev, pixKeyType: e.target.value }))}
                className="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white"
              >
                <option value="cpf">CPF</option>
                <option value="email">E-mail</option>
                <option value="phone">Telefone</option>
                <option value="random">Chave Aleatória</option>
              </select>
              
              <input
                type="text"
                placeholder="Chave PIX"
                value={withdrawData.pixKey}
                onChange={(e) => setWithdrawData(prev => ({ ...prev, pixKey: e.target.value }))}
                className="w-full p-3 bg-gray-800 border border-cyan-400/30 rounded-lg text-white"
              />
              
              <div className="flex space-x-3">
                <button
                  onClick={() => {
                    if (withdrawAmount <= balance && withdrawAmount >= 20) {
                      setBalance(prev => prev - parseFloat(withdrawAmount));
                      setWithdrawAmount('');
                      setWithdrawData({ fullName: '', pixKey: '', pixKeyType: 'cpf' });
                      setShowWithdraw(false);
                      alert(`Saque de R$ ${withdrawAmount} processado! Aguarde até 24h úteis.`);
                    } else {
                      alert('Valor inválido ou saldo insuficiente!');
                    }
                  }}
                  className="flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 rounded-lg"
                >
                  💸 Sacar
                </button>
                <button
                  onClick={() => setShowWithdraw(false)}
                  className="flex-1 bg-gray-600 text-white font-bold py-3 rounded-lg"
                >
                  Cancelar
                </button>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
